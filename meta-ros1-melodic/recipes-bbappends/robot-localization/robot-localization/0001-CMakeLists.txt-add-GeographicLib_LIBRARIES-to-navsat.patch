From fc64e10fe5871e4ad06bf5524dd656a0e0f08806 Mon Sep 17 00:00:00 2001
From: Martin Jansa <martin.jansa@lge.com>
Date: Mon, 12 Apr 2021 13:18:02 -0700
Subject: [PATCH] CMakeLists.txt: add GeographicLib_LIBRARIES to
 navsat_transform as well

* fixes message-relay build failure when it tries to link with libnavsat_transform.so:

FAILED: TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib/message_relay/message_relay_node
: && TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot-native/usr/bin/arm-webos-linux-gnueabi/arm-webos-linux-gnueabi-g++ -mthumb -mfpu=neon-vfpv4 -mfloat-abi=hard -mcpu=cortex-a7 -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fmacro-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0=/usr/src/debug/message-relay/0.0.2-1-r0                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0=/usr/src/debug/message-relay/0.0.2-1-r0                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot=                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot-native=  -fvisibility-inlines-hidden   -mthumb -mfpu=neon-vfpv4 -mfloat-abi=hard -mcpu=cortex-a7 -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot  -mthumb -mfpu=neon-vfpv4 -mfloat-abi=hard -mcpu=cortex-a7 -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fmacro-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0=/usr/src/debug/message-relay/0.0.2-1-r0                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0=/usr/src/debug/message-relay/0.0.2-1-r0                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot=                      -fdebug-prefix-map=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot-native=  -fvisibility-inlines-hidden   -mthumb -mfpu=neon-vfpv4 -mfloat-abi=hard -mcpu=cortex-a7 -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot -Wl,-O1 -Wl,--hash-style=gnu -Wl,--as-needed -Wl,-z,relro,-z,now -Wl,-O1 -Wl,--hash-style=gnu -Wl,--as-needed -Wl,-z,relro,-z,now   -rdynamic CMakeFiles/message_relay_node.dir/src/message_relay_node.cpp.o -o TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib/message_relay/message_relay_node  -Wl,-rpath,TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib:TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib:  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib/libmessage_relay_factory.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libekf.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libekf_localization_nodelet.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libfilter_base.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libfilter_utilities.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform_nodelet.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_filter.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_filter_utilities.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librobot_localization_estimator.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_robot_localization_listener.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libukf.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libukf_localization_nodelet.so  -lyaml-cpp  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libdiagnostic_updater.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libeigen_conversions.so  -lorocos-kdl  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/liborocos-kdl.so.1.4.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libtf2_ros.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libactionlib.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libmessage_filters.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libroscpp.so  -lpthread  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_chrono.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_filesystem.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole_log4cxx.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole_backend_interface.so  -llog4cxx  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_regex.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libtf2.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libxmlrpcpp.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libroscpp_serialization.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librostime.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_date_time.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libcpp_common.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_system.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_thread.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libconsole_bridge.so.0.4  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib/libmessage_processor.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/devel/lib/libfield_processor.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libekf.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libekf_localization_nodelet.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libfilter_base.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libfilter_utilities.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform_nodelet.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_filter.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_filter_utilities.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librobot_localization_estimator.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libros_robot_localization_listener.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libukf.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libukf_localization_nodelet.so  -lyaml-cpp  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libdiagnostic_updater.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libeigen_conversions.so  -lorocos-kdl  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/liborocos-kdl.so.1.4.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libtf2_ros.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libactionlib.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libmessage_filters.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libroscpp.so  -lpthread  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_chrono.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_filesystem.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole_log4cxx.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librosconsole_backend_interface.so  -llog4cxx  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_regex.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libtf2.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libxmlrpcpp.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libroscpp_serialization.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/librostime.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_date_time.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libcpp_common.so  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_system.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libboost_thread.so.1.75.0  TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/lib/libconsole_bridge.so.0.4 && :
TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so: error: undefined reference to 'GeographicLib::LocalCartesian::IntForward(double, double, double, double&, double&, double&, double*) const'
TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so: error: undefined reference to 'GeographicLib::LocalCartesian::IntReverse(double, double, double, double&, double&, double&, double*) const'
TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so: error: undefined reference to 'GeographicLib::LocalCartesian::Reset(double, double, double)'
TOPDIR/tmp-glibc/work/raspberrypi4-webos-linux-gnueabi/message-relay/0.0.2-1-r0/recipe-sysroot/usr/opt/ros/melodic/lib/libnavsat_transform.so: error: undefined reference to 'GeographicLib::Geocentric::WGS84()'
collect2: error: ld returned 1 exit status
ninja: build stopped: subcommand failed.

Upstream-Status: Pending

Signed-off-by: Martin Jansa <martin.jansa@lge.com>
---
 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index f13f373..faf6117 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -167,7 +167,7 @@ target_link_libraries(ekf_localization_node ros_filter ${catkin_LIBRARIES})
 target_link_libraries(ekf_localization_nodelet ros_filter ${catkin_LIBRARIES})
 target_link_libraries(ukf_localization_node ros_filter ${catkin_LIBRARIES})
 target_link_libraries(ukf_localization_nodelet ros_filter ${catkin_LIBRARIES})
-target_link_libraries(navsat_transform filter_utilities ros_filter_utilities ${catkin_LIBRARIES} ${EIGEN3_LIBRARIES})
+target_link_libraries(navsat_transform filter_utilities ros_filter_utilities ${catkin_LIBRARIES} ${EIGEN3_LIBRARIES} ${GeographicLib_LIBRARIES})
 target_link_libraries(navsat_transform_node navsat_transform ${catkin_LIBRARIES} ${GeographicLib_LIBRARIES})
 target_link_libraries(navsat_transform_nodelet navsat_transform ${catkin_LIBRARIES} ${GeographicLib_LIBRARIES})
 
